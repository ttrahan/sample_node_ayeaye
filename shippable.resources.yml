resources:

# resources for the box demo pipelines from CI thru TEST environment

################################

# add infrastructure resources

# add env - GKE cluster TEST
  - name: env-gke
    type: cluster
    integration: ttrahan-gke
    pointer:
      sourceName : "demo-shippable-gke"
      region: "us-east1-b"

################################

# Docker Image
  - name: img-sample-gcr
    type: image
    integration: ttrahan-gcr
    pointer:
      sourceName: gcr.io/shippable-gke/sample_node_ayeaye
      isPull: false
    seed:
      versionName: gke.1

################################

  - name: service-sample-test                             #required
    type: loadBalancer                          #required
    integration: ttrahan-gke
    pointer:
      sourceName: "service-sample-node-ayeaye"                    #required
      method: LoadBalancer
      clusterName: shippable-demo
      region: "Eastern US"
      namespace: shippable-gke
    version:
      ports:
        - name: public
          protocol: TCP
          port: 80
      selector:
        app: sample-node-ayeaye
        env: test

################################

# TEST resources

# Docker Image Options
  - name: img-opts-sample-test-gke
    type: dockerOptions
    version:
      memory: 64
      cpuShares: 128
      portMappings:
        - 8080:8080
      publishAllPorts : true
      labels:
        env: test
        app: sample-node-ayeaye

# env vars for Test
  - name: params-sample-test-gke
    type: params
    version:
      params:
        ENVIRONMENT: "TEST"
        PORT: 8080

# loadBalancer for test service
  - name: service-sample-test                             #required
    type: loadBalancer                          #required
    integration: ttrahan-gke
    pointer:
      sourceName: "service-sample-node-ayeaye-test"                    #required
      method: LoadBalancer
      clusterName: shippable-demo
      region: "Eastern US"
      namespace: shippable-gke
    version:
      ports:
        - name: public
          protocol: TCP
          port: 80
      selector:
        app: sample-node-ayeaye
        env: test

################################

# set service version seed
  - name: ver-sample-gke
    type: version
    seed:
      versionName: "1.0.0"

################################

# PROD resources

# Docker Image Options
  - name: img-opts-sample-prod-gke
    type: dockerOptions
    version:
      memory: 64
      cpuShares: 128
      labels:
        env: prod
        app: sample-node-ayeaye

# env vars for Prod
  - name: params-sample-prod-gke
    type: params
    version:
      params:
        ENVIRONMENT: "PROD"
        PORT: 80

# loadBalancer for test service
  - name: service-sample-prod                             #required
    type: loadBalancer                          #required
    integration: ttrahan-gke
    pointer:
      sourceName: "service-sample-node-ayeaye-prod"                    #required
      method: LoadBalancer
      clusterName: shippable-demo
      region: "Eastern US"
      namespace: shippable-gke
    version:
      ports:
        - name: public
          protocol: TCP
          port: 80
      selector:
        app: sample-node-ayeaye
        env: prod

# PROD replicas
  - name: replicas-sample-prod-gke
    type: replicas
    version:
      count: 2

# ################################
